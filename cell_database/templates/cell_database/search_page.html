{% extends "base_generic.html" %}

{% load static %}
{% block content %}


<style>
table {
    border-collapse:collapse;

}
table, th, td {
    border:1px solid black;}


</style>


<h1>Search Stuff</h1>



<form action="{% url 'cell_database:search_page' %}" method="post">
    {% csrf_token %}
    <table>
        <tr>

            {%if wet_cell_page_form %}
                Display Page: {{wet_cell_page_form.page_number}}
            {%endif%}
            <input type="submit" name = 'preview_wet_cell' value="Preview Wet Cell">


            {%if wet_cells_preview_form %}
                Showing page {{page_number}}/{{max_page_number}}.
                {{ wet_cells_preview_form }}
                {% if dataset_form %}
                    Target Dataset: {{ dataset_form.dataset }}
                {% endif %}
                <input type="submit" name = 'register_wet_cells_to_dataset' value="Register to Dataset">

            {% endif %}

        </tr>
        <tr>
            <table>
                {% if search_cell_id_range or search_dataset_membership %}
            <td valign="top">
            <h2>Cell ID Ranges</h2>
                <table>
                    <tr>
                        <th>
                            Cell ID Range:
                        </th>
                        <td>
                            Min (or exact)
                        </td>
                        <td>
                            Max (or blank)
                        </td>
                    </tr>
                    <tr>
                        <th>

                        </th>
                        <td>
                            {{ search_cell_id_range.cell_id_min_1}}
                        </td>
                        <td>
                            {{ search_cell_id_range.cell_id_max_1}}
                        </td>
                    </tr>
                    <tr>
                        <th>

                        </th>
                        <td>
                            {{ search_cell_id_range.cell_id_min_2}}
                        </td>
                        <td>
                            {{ search_cell_id_range.cell_id_max_2}}
                        </td>
                    </tr>
                    <tr>
                        <th>

                        </th>
                        <td>
                            {{ search_cell_id_range.cell_id_min_3}}
                        </td>
                        <td>
                            {{ search_cell_id_range.cell_id_max_3}}
                        </td>
                    </tr>


                </table>

            <h2>Dataset</h2>
                <table>
                    {{ search_dataset_membership.as_table }}
                </table>


            </td>

            {% endif %}


            {% if electrolyte_form %}
            <td valign="top">
            <h2>Electrolyte</h2>
                {%if electrolyte_page_form %}
                    Display Page: {{electrolyte_page_form.page_number}}
                {%endif%}
                <input type="submit" name = 'preview_electrolyte' value="Preview Electrolyte">
                {%if preview_electrolytes %}
                    {% if not preview_electrolytes|length == 0%}
                     Showing page {{electrolyte_page_number}}/{{electrolyte_max_page_number}}.
                        <table>
                            <tr>
                                <th>Preview Electrolytes</th>
                            </tr>
                            {% for electrolyte in preview_electrolytes %}
                                <tr>
                                    <td>{{electrolyte}}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    {% endif %}
                {% endif %}

                <table>{{ electrolyte_form.as_table }}</table>
                {% if electrolyte_composition_formset %}
                    {% csrf_token %}
                    {{ electrolyte_composition_formset.management_form }}
                    <table>
                        <tr>
                            <th>Molecule</th><th>Must have?</th><th>Amount</th><th>Tolerance</th>
                        </tr>
                        {% for form in electrolyte_composition_formset%}
                            <tr>
                                <td>{{ form.molecule}}</td><td>{{form.must_type}}</td><td>{{ form.ratio}}</td><td>{{ form.tolerance}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}

            </td>
        {% endif %}


        {% if search_dry_cell %}
            <td valign="top">
            <h2>Dry Cell</h2>
                {%if dry_cell_page_form %}
                    Display Page: {{dry_cell_page_form.page_number}}
                {%endif%}

                 <input type="submit" name = 'preview_dry_cell' value="Preview Dry Cell">
                 <input type="submit" name = 'preview_dry_cell_lot'value="Preview Box IDs">

                {%if preview_dry_cells %}
                    {% if not preview_dry_cells|length == 0%}
                Showing page {{dry_cell_page_number}}/{{dry_cell_max_page_number}}.
                        <table>
                            <tr>
                                <th>Preview Dry Cells</th>
                            </tr>
                            {% for dry_cell in preview_dry_cells %}
                                <tr>
                                    <td>{{dry_cell}}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    {% endif %}
                {% endif %}
                {%if preview_dry_cell_lots %}
                    {% if not preview_dry_cell_lots|length == 0%}
                 Showing page {{dry_cell_page_number}}/{{dry_cell_max_page_number}}.
                        <table>
                            <tr>
                                <th>Preview Box IDs</th>
                            </tr>
                            {% for dry_cell_lot in preview_dry_cell_lots %}
                                <tr>
                                    <td>{{dry_cell_lot}}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    {% endif %}
                {% endif %}
                <table>{{ search_dry_cell.as_table }}</table>
                {% if dry_cell_scalars %}
                    {% csrf_token %}
                    {{ dry_cell_scalars.management_form }}
                    <table>
                        <tr>
                            <th>Field Name</th><th>Amount</th><th>Tolerance</th><th>Exclude Missing Values</th>
                        </tr>
                        {% for form in dry_cell_scalars%}
                            <tr>
                                <td>{{ form.name}}</td><td>{{form.scalar}}</td><td>{{ form.tolerance}}</td><td>{{ form.exclude_missing}}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}

            </td>
        {% endif %}


        </table>
        </tr>
    </table>

</form>



{% endblock %}